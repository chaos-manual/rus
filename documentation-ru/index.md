# Введение

В этом руководстве мы описываем процесс сhaos engineering (CE), в том виде как он применяется для повышения надежности и управляемости крупных высоконагруженных систем. Мы разбираем конкретные случаи поиска и устранения сбоев и отвечаем на возникающие вопросы читателей.

## Что такое сhaos engineering (CE)

Наше рабочее определение - сhaos engineering (CE) это подтверждение 
надежности сложных информационных систем путем внесения
контролируемого разрушения для их ограниченной части. 

## Cфера применения 

Правильно выполненный сhaos engineering дает много преимуществ, но это передовой и дорогостоящий - по времени, компетенциям, организационным изменениям - метод. 

Мы считаем, что сhaos engineering актуален в следующих случаях: 

- проекты с высокой нагрузкой или сложной архитектурой, в которых выигрыши от повышения надежности 
  превышают стоимость работ по тестированию
- проекты, которые активно поддерживаются (если некому устранять уязвимости, нет смысла тестировать)
- распределенных системах (в монолитах ломаться всего будет меньше) 
- в случаях, когда надежность важна для клиентов и владельцев системы (причем не на словах)

Сhaos engineering не очень подходит для компании с 4 разработчиками и двумя серверами, поскольку в маленькой ИТ-системе выигрыши, скорее всего, будут небольшими. 


## Кто это все придумал?

[Черчилль в 18-м году](https://www.youtube.com/watch?v=f78sNWsg7NM).

Шутка. Все придумал Netflix.


## Начало пути 

У вас есть крупная ИТ-система, но она ломается в неподходящий 
момент с неясными последствиями. Вам надоело слышать "все устранили,
в следующий раз все будет хорошо", потому что в следуюший раз система ломается
каким-то другим, уникальным образом. Вы хотите гарантий, а не обещаний.
Вы встречаете сопротивление и вам говорят, что вообще-то (тут много разных
аргументов) и надо просто дать всем работать как и раньше.  

Потом становится ясно, что инциденты в системе не случайны. Они 
результат ошибок в проектировании, реализации и эксплуатации,  
о которых либо не знали, либо не хотели говорить, либо о которых не хотели слышать. 
Клиентам больше нравятся системы, которые не падают, и при удобном случае
они, если могут, выбирают другие сервисы других компаний. Это уже никому не нравится. 

Команда и руководство готовы к тому, чтобы в следующем проекте что-то сделать 
по-другому. Кто-то рассказывает, что слышал о сhaos engineering и предлагает посмотреть 
как система ведет себя при ну хотя бы при наиболее частых аварийных ситуациях. Команда
планирует эксперименты с системой и углубляется в методологию как это сделать лучше.

Здесь самое время взять наше руководство и почитать, где не набить 
шишек и воспользоваться чужими. Даже если вы накопили определенный опыт
сhaos engineering, надеемся, что руководство будет также полезно.

## Для кого это руководство

Это руководство предназначено, в первую очередь, для тех, кто уже сделал первые шаги в chaos engineering и у есть кого накопились практические вопросы о том, как двигаться дальше. Мы ориентируемся на команды, которые уже попробовали какие-то тесты с fault injection и планируют развивать это направление работы.

Первые тесты часто приносят разочарование. Зачем вообще «ломать» систему, если она и так худо-бедно работает? Что именно мы показали этими тестами? Что именно мы протестировали? Кто и как будет заниматься доработкой системы? И несмотря на всю неопределённость уже сейчас нужно принять какие-то нетривиальные, сложные решения и быть готовым, что все получится не сразу.

Мы надеемся, что наше описание шагов и методик, проверенных в течение нескольких лет работы в области chaos engineering, позволит вам избежать хотя бы некоторых ошибок, сэкономит время на планирование и реализацию тестов, и в целом придаст уверенности.


---

Раздел:

Кто может использовать данный материал и кому, первую очередь,
адресован этот Manual:**

- **Разработчикам тех сервисов, которые очень чувствительны к времени простоя.** 
Если пользователи вашего сервиса чувствуют себя комфортно,
при его падении на несколько десятков минут или даже часов, то чаще 
всего сhaos еngineering здесть просто не нужен. В этам случае 
нужно просто стабилизировать систему, делать правильное и своевременное 
резервное копирование и работать процедрами над восстановления системы. 

- **Корпорациям, которые борются за надежность сервисов**, и у которых
количество сотрудников IT более 300. Представим, что команда составляет около 
7-10 человек, то есть у вас получается 30 команд и более. Эти команды, 
скорее всего, пишут какие-то сложные сервисы и для них требуется верифицировать 
как качество кода, так и стабильность работы систем в стадии эксплуатации. 
Требуется chaos engineering, потому что без сопоставимой методики 
мы никогда не узнаем, как определить состояние, уязвимости и поведение
системы в стрессовых условиях.

- **Компаниям, использующим микросервисную архитектуру, либо serverless.**.
Фактические переходя на этот тип архитектуры команды должны в
обязательном порядке проводить Chaos Engineering, потому что появляется
новые уровни виртуализации появляется большее количество ошибок и так
далее, то есть работа с устойчивостью и стабильностью в микросервисах,
serverless системах она фактически чуть ли не заложена в ДНК ее нужно
обязательно испытывать тестировать. Из мира микросервисов мы все знаем,
что в Istio практически из коробки встроенные конкретные инструменты,
которые позволяют легко проводить Chaos Engineering в
системе.

Если у вас 10-100 ИС, а может быть и более и вы хотите построить
культуру Chaos Engineering у себя в компании, вы про неё прочитали много
мануалов, но не знаете как сделать это системно, этот мануал тоже для
вас. Материалы, которые сейчас находятся в интернете чаще всего не дают
руководство к действию: делай раз, делай два, делай три. В данном
мануале мы попробуем это сделать.

**Manual будет полезен team-lead, которые уже погружены в Chaos
Engineering** и хотят, после первых тестов и результатов, построить
полноценный процесс работы от инцидентов до регистрации, на потоке,
точек отказа и построения риск-модели на базе этого.

**И конечно же этот Manual в деталях должен быть интересен
разработчикам,** чтобы понимать, как писать системы, как написать не
просто сервис, а как написать устойчивый сервис. Ops Engineerам, чтобы
понимать, как бороться с инцидентами и какие они бывают и вообще
понимать всю кухню Chaos Engineering. Потому что в первую очередь
результатами и продуктами пользуются как раз они и чувствительно
результаты будут ярко видны как раз им. И командам, которые будут
тестировать продукты на надежность, Chaos-team, которые будут
непосредственно искать точки отказа в системах и проводить
тесты.

---

## Что внутри

- Основой нашего руководства является описание процесса сhaos engineering, включая его отправные точки и результаты, а также взаимосвязь с другими процессами в компании. См. раздел ["Шаги"](process.md). 
- Раздел ["Проблемы и решения"](injections.md) - это тот объем знаний, который помогает классифицировать уязвимости, анализровать ИТ-систему и разрабатывать к ней тесты. Мы предоставляем случаи сбоев и способы их устранения.
- Мы также ведем [словарь терминов](glossary.md), чтобы помочь ориентироваться специфическом сленге CЕ и снимать разночтения.

## Особенности подхода

То, о чем мы рассказываем – не какая-то темная магия. Это не реклама какого-то дополнительного софта. Мы считаем, что основные результаты в chaos engineering достигаются путем приобретения новых навыков персонала и организационных изменениях в процессах работы. 

Получить [много девяток](https://en.wikipedia.org/wiki/High_availability) в показатель надежности - это не единовременный подвиг, а многоходовая партия. Мы приглашаем ее пройти. 

## Авторы

Это руководство написано [Дмитрием Якубовским (Сбербанк)](https://twitter.com/d_yakubovsky) и [Евгением Погребняком (МГИМО)](https://twitter.com/PogrebnyakE).
